@if (showDashboard) {
  <!-- Dashboard (quando não há query params) -->
  <app-category-suggestions-dashboard></app-category-suggestions-dashboard>
} @else {
  <!-- Lista (quando há query params de status) -->
  <div class="container">
    <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>
    
    <div class="header">
      <h1>{{ pageTitle }}</h1>
    </div>

    <app-loading [loading]="loading" message="Carregando sugestões..."></app-loading>

    @if (!loading && error) {
      <!-- Error -->
      <div class="error">
        <p>{{ error }}</p>
        <button (click)="loadSuggestions()">Tentar novamente</button>
      </div>
    }

    @if (!loading && !error && suggestions.length === 0) {
      <!-- Empty State -->
      <div class="empty">
        @if (currentStatus === 'pending') {
          <p>Nenhuma sugestão pendente encontrada.</p>
        }
        @if (currentStatus === 'approved') {
          <p>Nenhuma sugestão aprovada encontrada.</p>
        }
        @if (currentStatus === 'rejected') {
          <p>Nenhuma sugestão rejeitada encontrada.</p>
        }
      </div>
    }

    @if (!loading && !error && suggestions.length > 0) {
      <!-- Lista de Sugestões -->
      <div class="suggestions-list">
        @for (suggestion of suggestions; track suggestion.id) {
          <div class="card suggestion-card">
            <div class="suggestion-header">
              <div class="header-left">
                <div class="badge-id">{{ suggestion.id }}</div>
                <h2>{{ suggestion.suggested_path }}</h2>
              </div>
              <div class="badge" 
                   [class.pending]="suggestion.status === 'pending'"
                   [class.approved]="suggestion.status === 'approved'"
                   [class.rejected]="suggestion.status === 'rejected'">
                {{ translateStatus(suggestion.status) }}
              </div>
            </div>

            <div class="suggestion-content">
              <div class="ticket-info">
                <p><strong>Ticket ID:</strong> #{{ suggestion.ticket_id }}</p>
                <p><strong>Título:</strong> {{ decodeHtml(suggestion.ticket_title) }}</p>
                <p><strong>Criado em:</strong> {{ formatDate(suggestion.created_at) }}</p>
              </div>

              @if (suggestion.ticket_content) {
                <div class="ticket-content">
                  <p><strong>Conteúdo do ticket:</strong></p>
                  <p 
                    class="content-text content-clickable" 
                    (click)="openContentDialog(suggestion.ticket_title, suggestion.ticket_content)"
                    title="Clique para ver o conteúdo completo">
                    {{ decodeHtml(suggestion.ticket_content) }}
                  </p>
                </div>
              }
            </div>

            @if (!isApprovedView) {
              <div class="suggestion-actions">
                <p-button 
                  label="Aprovar"
                  icon="pi pi-check"
                  severity="success"
                  (onClick)="approveSuggestion(suggestion.id)"
                  class="btn-approve">
                </p-button>
                <p-button 
                  label="Rejeitar"
                  icon="pi pi-times"
                  severity="danger"
                  (onClick)="rejectSuggestion(suggestion.id)"
                  class="btn-reject">
                </p-button>
              </div>
            }
          </div>
        }
      </div>
    }
  </div>

  <!-- Dialog para exibir conteúdo do ticket -->
  <app-content-dialog
    [(visible)]="showContentDialog"
    [title]="dialogTitle"
    [content]="dialogContent">
  </app-content-dialog>
}
